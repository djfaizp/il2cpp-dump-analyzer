# IL2CPP Dump Analyzer MCP Server

A Model Context Protocol (MCP) server for analyzing IL2CPP dump.cs files from Unity games. This package provides a specialized RAG (Retrieval-Augmented Generation) system that enables AI assistants to understand and analyze Unity game code structures.

## Features

- **Unity IL2CPP dump analysis**: Parse and analyze dump.cs files generated by IL2CPP
- **MonoBehaviour discovery**: Find and analyze Unity MonoBehaviour classes
- **Class hierarchy analysis**: Understand inheritance relationships
- **Method signature lookup**: Search for specific methods and their signatures
- **Enum value retrieval**: Access enum definitions and values
- **Advanced filtering and search**: Powerful search capabilities with semantic similarity
- **Dependency mapping and analysis**: Analyze class dependencies, coupling, and circular references
- **Cross-reference analysis**: Find all references to classes, methods, fields, and other entities
- **Design pattern detection**: Identify and analyze common design patterns (Singleton, Observer, Factory, etc.)

## Installation

```bash
npm install -g @il2cpp/dump-analyzer-mcp
```

## Usage

### As an MCP Server

Add to your MCP client configuration:

```json
{
  "mcpServers": {
    "il2cpp-dump-analyzer": {
      "command": "npx",
      "args": ["@il2cpp/dump-analyzer-mcp", "start"],
      "description": "IL2CPP Dump Analyzer MCP Server for Unity game analysis"
    }
  }
}
```

### Command Line

```bash
# Start the MCP server
il2cpp-mcp start

# The server will look for dump.cs in the current directory
# Or specify a custom path via environment variables
```

## Configuration

Set these environment variables:

- `DUMP_FILE_PATH`: Path to your IL2CPP dump.cs file (default: ./dump.cs)
- `EMBEDDING_MODEL`: Embedding model to use (default: Xenova/all-MiniLM-L6-v2)
- `PORT`: Server port (default: 3000)
- `HOST`: Server host (default: localhost)

## MCP Tools Available

### Core Analysis Tools
- `search_code`: Search through the IL2CPP dump with semantic similarity and filtering
- `find_monobehaviours`: Find Unity MonoBehaviour classes
- `find_class_hierarchy`: Analyze class inheritance relationships and methods
- `find_enum_values`: Retrieve enum definitions and values

### Advanced Analysis Tools
- `analyze_dependencies`: Analyze class dependencies, coupling metrics, and circular references
  - **Parameters**:
    - `class_name` (required): Target class to analyze
    - `analysis_type` (optional): "incoming" | "outgoing" | "bidirectional" | "circular" (default: "bidirectional")
    - `depth` (optional): Traversal depth 1-5 (default: 3)
    - `include_system_types` (optional): Include Unity/System dependencies (default: false)
  - **Returns**: Dependency graph with coupling metrics, circular dependency detection, and refactoring insights

- `find_cross_references`: Find all references to classes, methods, fields, properties, or events
  - **Parameters**:
    - `target_name` (required): Name of the target entity to find references for
    - `target_type` (required): "class" | "method" | "field" | "property" | "event" | "enum" | "interface"
    - `reference_type` (optional): "usage" | "inheritance" | "implementation" | "declaration" | "all" (default: "all")
    - `include_nested` (optional): Include nested types (default: true)
    - `include_system_types` (optional): Include Unity/System types (default: false)
    - `max_results` (optional): Maximum results 1-200 (default: 50)
  - **Returns**: Cross-reference analysis with usage patterns, context, and relationship details

- `find_design_patterns`: Detect and analyze design patterns in the IL2CPP codebase
  - **Parameters**:
    - `pattern_types` (required): Array of patterns to detect: ["singleton", "observer", "factory", "strategy", "command", "state", "decorator", "adapter", "facade", "proxy", "builder", "template_method", "chain_of_responsibility", "mediator", "memento", "visitor", "flyweight", "composite", "bridge", "abstract_factory", "prototype", "iterator"]
    - `confidence_threshold` (optional): Minimum confidence level 0.1-1.0 (default: 0.7)
    - `include_partial_matches` (optional): Include partial pattern implementations (default: true)
    - `namespace_scope` (optional): Limit search to specific namespace pattern
    - `exclude_unity_patterns` (optional): Exclude Unity-specific pattern implementations (default: false)
    - `max_results_per_pattern` (optional): Maximum results per pattern type 1-50 (default: 10)
  - **Returns**: Design pattern analysis with confidence scores, implementation details, evidence, and architectural insights

## Requirements

- Node.js 18+
- IL2CPP dump.cs file from a Unity game

## License

MIT

## Repository

https://github.com/djfaizp/il2cpp-dump-analyzer
